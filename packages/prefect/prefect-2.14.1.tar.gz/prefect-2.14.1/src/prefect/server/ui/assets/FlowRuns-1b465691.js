import{d as P,a2 as Q,f as W,i as f,g as b,h as r,a3 as Y,a4 as Z,a5 as J,a6 as K,a7 as X,q as m,j as p,c as n,k as c,o as s,p as a,u as e,a8 as $,n as C,U as ee,G as F,a9 as se,aa as oe,a as d,Y as _,ab as te,ac as le,ad as ne,ae,af as ue,ag as re,ah as ce,ai as de,O as ie,z as fe,aj as me}from"./index-ae7a8163.js";import{u as pe}from"./usePageTitle-82788dd8.js";const _e={class:"flow-runs__list"},we={class:"flow-runs__list-controls--right"},V=3e4,ye=P({__name:"FlowRuns",setup(ve){const h=Q(),w=W(),v=f(),R=b(w.flowRuns.getFlowRunsCount,[{}]),x=r(()=>R.executed),N=r(()=>R.response===0),i=f(),T=Y(i,1200),{filter:o,isCustomFilter:B}=Z({flowRuns:{nameLike:T}}),k=r({get(){return o.flowRuns.parentTaskRunIdNull},set(g){o.flowRuns.parentTaskRunIdNull=g?!0:void 0}}),S=b(w.ui.getFlowRunHistory,[o],{interval:V}),U=r(()=>S.response??[]),{flowRuns:y,total:H,subscriptions:O,next:I}=J(o,{mode:"infinite",interval:V}),u=f([]),{margin:L}=K(),M=()=>({rootMargin:L.value}),{stuck:j}=X(v,M),z=r(()=>({listControls:{"flow-runs__list-controls--stuck":j.value&&m.md}}));function A(){h.push(me.flowRuns())}const D=()=>{u.value=[],O.refresh()};return pe("Flow Runs"),(g,t)=>{const G=p("p-toggle"),q=p("p-button"),E=p("p-layout-default");return s(),n(E,{class:"flow-runs"},{header:c(()=>[a(e($))]),default:c(()=>[x.value?(s(),C(F,{key:0},[N.value?(s(),n(e(ee),{key:0})):(s(),C(F,{key:1},[a(e(se)),e(m).md?(s(),n(e(oe),{key:0,history:U.value,"start-date":e(o).flowRuns.expectedStartTimeAfter,"end-date":e(o).flowRuns.expectedStartTimeBefore,class:"flow-runs__chart"},null,8,["history","start-date","end-date"])):d("",!0),_("div",_e,[_("div",{ref_key:"listControls",ref:v,class:te(["flow-runs__list-controls",z.value.listControls])},[_("div",we,[u.value.length==0?(s(),n(e(le),{key:0,count:e(H),label:"Flow run"},null,8,["count"])):(s(),n(e(ne),{key:1,count:u.value.length},null,8,["count"])),a(e(ae),{selected:u.value,onDelete:D},null,8,["selected"])]),a(G,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=l=>k.value=l),class:"flow-runs__subflows-toggle",append:"Hide subflows"},null,8,["modelValue"]),e(m).md?(s(),n(e(ue),{key:0,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=l=>i.value=l),placeholder:"Search by run name",label:"Search by run name"},null,8,["modelValue"])):d("",!0),a(e(re),{modelValue:e(o).sort,"onUpdate:modelValue":t[2]||(t[2]=l=>e(o).sort=l),class:"flow-runs__sort"},null,8,["modelValue"])],2),a(e(ce),{selected:u.value,"onUpdate:selected":t[3]||(t[3]=l=>u.value=l),selectable:"","flow-runs":e(y),onBottom:e(I)},null,8,["selected","flow-runs","onBottom"]),e(y).length?d("",!0):(s(),n(e(de),{key:0},ie({_:2},[e(B)?{name:"actions",fn:c(()=>[a(q,{small:"",onClick:A},{default:c(()=>[fe(" Clear Filters ")]),_:1})]),key:"0"}:void 0]),1024))])],64))],64)):d("",!0)]),_:1})}}});export{ye as default};

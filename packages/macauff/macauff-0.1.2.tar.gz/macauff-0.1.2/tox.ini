[tox]
envlist =
	py{38,39,310,311}-test{,-cov}
	build_docs

isolated_build = true

install_command = python -I -m pip {opts} {packages} --config-settings=cmake.build-type="Debug"

[testenv]
changedir = .tmp/{envname}

deps =
	pytest
	cov: coverage
	cov: pytest-cov
	build_docs: sphinx-fortran

extras =
	test
	build_docs: docs

commands =
    !cov: pytest --pyargs macauff {posargs}
    cov: pytest --pyargs macauff --cov macauff {posargs} --cov-config={toxinidir}/tox.ini
    cov: coverage xml -o {toxworkdir}/coverage.xml

[testenv:build_docs]
changedir = docs
extras = docs
commands = sphinx-build -W -b html . _build/html

linear_mode: "gather"  # `full`, `gather`, `sparse`